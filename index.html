
<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø¬Ø¯Ø§Ø± Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f9f9f9; padding: 20px; direction: rtl; }
    h1 { text-align: center; color: #444; }
    .card { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .card input, .card textarea, .card button { width: 100%; margin: 10px 0; padding: 10px; font-size: 16px; }
    .memory-wall { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .memory-card { background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; }
    .memory-card img, .memory-card video { width: 100%; max-height: 250px; object-fit: cover; }
    .memory-content { padding: 15px; }
  </style>
</head>
<body>
  <h1>ğŸ“¸ Ø¬Ø¯Ø§Ø± Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª</h1>

  <div class="card">
    <input type="file" id="mediaInput" accept="image/*,video/*" />
    <textarea id="textInput" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø°ÙƒØ±Ø§Ùƒ Ù‡Ù†Ø§..."></textarea>
    <input type="date" id="dateInput" />
    <button onclick="addMemory()">â• Ø£Ø¶Ù Ø§Ù„Ø°ÙƒØ±Ù‰</button>
  </div>

  <div class="memory-wall" id="memoryWall"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBAM9pRhlQN86MYMA0_366w-0U_Y0rq28A",
      authDomain: "memorywall-514a4.firebaseapp.com",
      projectId: "memorywall-514a4",
      storageBucket: "memorywall-514a4.appspot.com"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    async function addMemory() {
      const file = document.getElementById('mediaInput').files[0];
      const text = document.getElementById('textInput').value;
      const date = document.getElementById('dateInput').value;
      if (!file || !text || !date) return alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");

      const fileRef = storageRef(storage, 'media/' + Date.now() + '_' + file.name);
      await uploadBytes(fileRef, file);
      const url = await getDownloadURL(fileRef);

      await addDoc(collection(db, "memories"), {
        mediaUrl: url,
        mediaType: file.type.startsWith("video") ? "video" : "image",
        text,
        date,
        likes: 0,
        timestamp: new Date()
      });

      alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø°ÙƒØ±Ù‰!");
      window.location.reload();
    }

    async function loadMemories() {
      const wall = document.getElementById('memoryWall');
      const snap = await getDocs(collection(db, "memories"));
      snap.forEach(doc => {
        const mem = doc.data();
        const card = document.createElement("div");
        card.className = "memory-card";
        card.innerHTML = `
          ${mem.mediaType === 'video'
            ? `<video controls src="${mem.mediaUrl}"></video>`
            : `<img src="${mem.mediaUrl}" alt="Memory">`}
          <div class="memory-content">
            <p>${mem.text}</p>
            <small>ğŸ“… ${mem.date}</small>
          </div>
        `;
        wall.appendChild(card);
      });
    }

    loadMemories();
  </script>
</body>
</html>
